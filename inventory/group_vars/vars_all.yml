---
# Global Variables for Cyber Range Automation
# These variables are available to all hosts and playbooks

# ==========================================
# Campaign Configuration
# ==========================================
class_code: 1
class_name: "cyber-war-gaming"
course_prefix: "CIS4416"
max_student_groups: 2

# Campaign execution settings
campaign_duration_hours: 24
campaign_id: "{{ course_prefix }}_{{ ansible_date_time.epoch }}"

# ==========================================
# Proxmox Configuration
# ==========================================
proxmox_api_host: "192.168.68.89"
proxmox_api_user: "root@pam"
proxmox_api_token_id: "ansible-token"
proxmox_api_token_secret: "fa4dacce-8bd6-4cc4-a6ae-04369af6600b"
proxmox_verify_ssl: false
proxmox_node: "hm-hcr-08"

# Storage configuration
storage: "raid-lvm"
ovf_storage: "ovfstore"
iso_storage: "ISO_Library"

# ==========================================
# VM Templates (OVF Files)
# ==========================================
templates:
  pfsense_spark: "/mnt/pve/ovfstore/TEMPLATE-pfsense-spark.ovf"
  pfsense_instructor: "/mnt/pve/ovfstore/TEMPLATE-pfsense-instructor.ovf"
  pfsense_student: "/mnt/pve/ovfstore/TEMPLATE-pfsense-student.ovf"
  kali: "/mnt/pve/ovfstore/TEMPLATE-kali-20241124-Experiment.ovf"
  ms3_ubuntu: "/mnt/pve/ovfstore/TEMPLATE-ms3-ubuntu.ovf"
  ms3_windows: "/mnt/pve/ovfstore/TEMPLATE-ms3-windows.ovf"
  security_onion: "/mnt/pve/ovfstore/TEMPLATE-security-onion.ovf"

# ISO files
isos:
  windows_server_2008: "ISO_Library:iso/WS2008R2SP1-KB4474419.iso,media=cdrom,size=54894K"

# ==========================================
# VM ID Allocation
# ==========================================
vm_ids:
  # Infrastructure
  spark_pfsense: 50
  instructor_pfsense: 100
  instructor_kali: 103
  security_onion: 109

  # Student VMs (formula-based)
  student_pfsense_base: 200 # 201, 202, etc.
  student_vm_base: 9000 # 9101-9104, 9201-9204, etc.

# VM ID formulas (for reference)
# Student pfSense:  200 + group_id
# Student Kali 1:   9000 + (group_id * 100) + 1
# Student Kali 2:   9000 + (group_id * 100) + 2
# Student Ubuntu:   9000 + (group_id * 100) + 3
# Student Windows:  9000 + (group_id * 100) + 4

# ==========================================
# Network Configuration
# ==========================================

# Bridge naming convention: vmbr[Class][Type][Group]
# Class: 1=Cyber War Gaming, 2=Ethical Hacking, 3=Malware Analysis
# Type: 0=LAN, 5=WAN
# Group: 001-015=Students, 255=Instructor

bridges:
  # Infrastructure
  management: "vmbr0.68"
  spark_wan: "vmbr51"

  # Instructor
  instructor_lan: "vmbr10255"

  # Student bridges (prefixes)
  student_wan_prefix: "vmbr15" # vmbr15001, vmbr15002, etc.
  student_lan_prefix: "vmbr10" # vmbr10001, vmbr10002, etc.

# IP addressing scheme
ip_ranges:
  # Management network
  management_network: "192.168.68.0/24"
  management_gateway: "192.168.68.1"
  proxmox_ip: "192.168.68.89"

  # Instructor network
  instructor_network: "143.88.255.0/24"
  instructor_gateway: "143.88.255.1"
  security_onion_ip: "143.88.255.9"
  instructor_kali_ip: "143.88.255.10"

  # WAN interconnects (point-to-point /30 subnets)
  wan_network: "143.88.0.0/24"

  # Student LANs
  student_network_base: "143.88" # 143.88.1.0/24, 143.88.2.0/24, etc.

# IP formulas (for reference)
# Instructor OPT interface: 143.88.0.(4*group_id - 3)/30
# Student WAN IP:          143.88.0.(4*group_id - 2)/30
# Student LAN network:     143.88.{group_id}.0/24
# Student LAN gateway:     143.88.{group_id}.1

# ==========================================
# Student Group Definitions
# ==========================================
student_groups:
- id: 1
  name: "group1"
  wan_bridge: "vmbr15001"
  lan_bridge: "vmbr10001"
  wan_ip: "143.88.0.2/30"
  wan_gateway: "143.88.0.1"
  lan_network: "143.88.1.0/24"
  lan_gateway: "143.88.1.1"
  instructor_opt: "OPT1"
  instructor_opt_ip: "143.88.0.1/30"

- id: 2
  name: "group2"
  wan_bridge: "vmbr15002"
  lan_bridge: "vmbr10002"
  wan_ip: "143.88.0.6/30"
  wan_gateway: "143.88.0.5"
  lan_network: "143.88.2.0/24"
  lan_gateway: "143.88.2.1"
  instructor_opt: "OPT2"
  instructor_opt_ip: "143.88.0.5/30"

# ==========================================
# Automation Configuration
# ==========================================
automation:
  # Auto-runner settings
  auto_run_delay: 60 # seconds to wait after boot

  # Cron schedule for automatic campaigns
  cron_schedule: "@reboot"

  # Campaign defaults
  default_duration_hours: 24

  # Retry settings
  ssh_retry_count: 60
  ssh_retry_delay: 10

  # Boot wait times
  vm_boot_wait_seconds: 60
  pfsense_boot_wait_seconds: 120

# ==========================================
# SSH Configuration
# ==========================================
ssh:
  # SSH keys
  analyst_key_path: "/home/analyst/.ssh/id_rsa"
  analyst_pubkey_path: "/home/analyst/.ssh/id_rsa.pub"

  # Common SSH options
  common_args: "-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null"
